<div class="input-area">
    <div class="input-container">
        <textarea @bind="InputText"
                  @bind:event="oninput"
                  @onkeydown="HandleKeyDown"
                  placeholder="Ask about your documents..."
                  rows="1"></textarea>
        <button id="send-btn"
                disabled="@(string.IsNullOrWhiteSpace(InputText) || IsSending)"
                @onclick="SendMessage">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path>
            </svg>
        </button>
    </div>
</div>

@code {
    [Parameter] public EventCallback<string> OnSend { get; set; }
    [Parameter] public bool IsSending { get; set; }

    private string InputText { get; set; } = "";

    private async Task SendMessage()
    {
        var text = InputText?.Trim();
        if (string.IsNullOrEmpty(text) || IsSending) return;

        InputText = "";
        await OnSend.InvokeAsync(text);
    }

    private async Task HandleKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" && !e.ShiftKey)
        {
            await SendMessage();
        }
    }
}
